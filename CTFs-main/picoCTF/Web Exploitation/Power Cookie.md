# Power Cookie - picoCTF Writeup

## Challenge Details
- **Name:** Power Cookie
- **Author:** LT 'syreal' Jones
- **Description:** Can you get the flag?
- **Debug Info:** [u:702468 e: p: c:288 i:296092]
- **Category:** Web Exploitation

## Initial Reconnaissance
After launching the challenge instance, I navigated to the website and started investigating how authentication and authorization might be handled. One of the most common ways websites manage user sessions is through cookies.

### What Are Cookies?
Cookies are small pieces of data stored in the browser that websites use to remember user preferences, authentication states, and other information. They are often used to manage logins and user privileges.

### Inspecting Cookies
Using the browser's developer tools (F12 -> Application -> Cookies), I checked the stored cookies for the website.

1. Open Developer Tools:
   - Chrome: `F12` or `Ctrl+Shift+I`
   - Firefox: `F12` or `Ctrl+Shift+I`
2. Navigate to the `Application` tab (Chrome) or `Storage` tab (Firefox).
3. Click on `Cookies` and select the domain for the challenge.
4. Observe the stored cookies.

I noticed a cookie named `admin` with a value of `0`, suggesting that the website might be using it to determine user privileges.

## Exploiting the Vulnerability
Understanding that the admin status was likely controlled via the cookie, I decided to modify it:

1. Double-click on the `admin` cookie value.
2. Change its value from `0` to `1`.
3. Refresh the page.

### Why Does This Work?
This vulnerability exists because the website is trusting user-controlled data (cookies) without verifying it on the server side. Secure applications should store sensitive information like authentication status on the server, not in client-side cookies.

## Retrieving the Flag
After modifying the cookie and refreshing the page, I was granted admin privileges, and the flag was displayed on the page.

## Mitigation
To prevent this kind of vulnerability, web applications should:
- Use server-side session management instead of relying on client-side authentication tokens.
- Implement signed or encrypted cookies to prevent tampering.
- Verify privileges on the server before granting access to restricted resources.

## Conclusion
This challenge demonstrated a common web security issue: trusting client-side data. By modifying a cookie value, I was able to escalate privileges and retrieve the flag. Always be cautious about what data is being stored in cookies when developing web applications!

**Flag:** (picoCTF{gr4d3_A_c00k13_65fd1e1a})

