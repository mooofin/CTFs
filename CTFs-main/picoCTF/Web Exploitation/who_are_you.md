# PicoCTF 2024: HTTP Headers Manipulation Challenge Writeup

## Introduction
In this challenge, we were presented with a website that enforced strict access control based on HTTP headers. Our objective was to bypass these restrictions by modifying request headers appropriately. By systematically altering each header as per the website's responses, we successfully obtained the flag.

## Understanding HTTP Headers
HTTP headers provide essential metadata in HTTP requests and responses. They can dictate how servers interpret requests, enforce security measures, and even restrict access based on user agents, referers, timestamps, and geolocation. This challenge required knowledge of various HTTP headers to manipulate access conditions dynamically.

---

## Step-by-Step Solution

### Step 1: Changing the User-Agent Header
**Initial Response:** The website explicitly stated that only the official "PicoBrowser" was allowed to access it.

**Solution:** We intercepted our request and changed the `User-Agent` header to `PicoBrowser`.

```http
User-Agent: PicoBrowser
```

### Step 2: Adding a Referer Header
**New Restriction:** The server rejected our request, stating that it does not accept visitors from another site.

**Solution:** We added a `Referer` header, setting it to the challenge domain to simulate an internal request.

```http
Referer: mercury.picoctf.net:36622
```

### Step 3: Adjusting the Date Header
**New Restriction:** The website specified that it only worked in the year 2018.

**Solution:** We added a `Date` header with a timestamp from 2018.

```http
Date: Wed, 21 Oct 2018 07:28:00 GMT
```

### Step 4: Enabling Do Not Track (DNT)
**New Restriction:** The site required that users should not be tracked.

**Solution:** We added the `DNT` (Do Not Track) header to indicate a preference for privacy.

```http
DNT: 1
```

### Step 5: Spoofing an IP Address for Geolocation
**New Restriction:** The website required users to be from Sweden.

**Solution:** We used the `X-Forwarded-For` header to simulate a Swedish IP address.

```http
X-Forwarded-For: 102.177.146.1
```

### Step 6: Changing the Accept-Language Header
**New Restriction:** The site indicated that we did not speak Swedish.

**Solution:** We set the `Accept-Language` header to Swedish (`sv-sv`).

```http
Accept-Language: sv-sv,sv;q=0.5
```

---

## Final HTTP Request
After implementing all these header modifications, our final HTTP request looked like this:

```http
GET / HTTP/1.1
Host: mercury.picoctf.net:36622
User-Agent: PicoBrowser
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: sv-sv,sv;q=0.5
Accept-Encoding: gzip, deflate
Referer: mercury.picoctf.net:36622
Connection: close
DNT: 1
X-Forwarded-For: 102.177.146.1
Date: Wed, 21 Oct 2018 07:28:00 GMT
Upgrade-Insecure-Requests: 1
```

---


