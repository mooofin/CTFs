<img width="687" height="720" alt="screenshot-1752833841" src="https://github.com/user-attachments/assets/09e06e23-6c45-4b8f-9168-9682a96e3153" />


I began by analyzing the `vuln.c` source and identified a buffer overflow vulnerability in the `vuln()` function. The vulnerability is caused by an unbounded `gets()` call on a 128-byte buffer within a 32-bit PE executable. My objective was to redirect execution to the `win()` function, which I located at address `0x00401530` using `objdump`.

#### **Exploitation**

To find the precise offset needed to overwrite the return address, I used a pwntools script to generate and send a cyclic pattern. After the program crashed, I used the value that overwrote the EIP register to calculate the required offset as 140 bytes.

I then constructed the payload. It consisted of 140 bytes of padding followed by the little-endian address of the `win()` function (`\x30\x15\x40\x00`).

I executed the exploit by piping this payload to the remote server with `netcat`. This overwrote the return address on the stack, successfully redirecting program control to the `win()` function and causing it to print the flag.

#### **Execution Command**

```bash
(python3 -c 'import sys; sys.stdout.buffer.write(b"a"*140 + b"\x30\x15\x40\x00")') | nc saturn.picoctf.net 55701
```

#### **Flag**

`picoCTF{Un_v3rr3_d3_v1n_2ef42747}`


<img width="946" height="826" alt="screenshot-1752834074" src="https://github.com/user-attachments/assets/8a6175c5-c8cf-4a7e-82fb-8209bb527ee0" />
