During analysis of the `buy_stonks` function in the provided C program, I identified a critical format string vulnerability in the `printf(user_buf)` statement. This vulnerability occurs when user-controlled input is passed directly to printf without proper formatting, allowing potential memory leaks.  

To exploit this, I crafted a payload consisting of multiple `%X` format specifiers, which instruct printf to print hexadecimal values from the stack. When executed, the program outputs memory contents in hexadecimal format. Using an online hex-to-ASCII converter (rapidtables.com), I processed the leaked memory data and discovered the flag stored in reverse order. After reversing the extracted bytes, I successfully reconstructed the flag in its correct format.  

This exploit demonstrates how improper handling of user input in format strings can lead to information disclosure. The vulnerability arises from the unchecked `scanf("%300s", user_buf)` followed by the direct use of `user_buf` in printf, bypassing proper string formatting safeguards. Proper mitigation would require using `printf("%s", user_buf)` instead to prevent unintended memory access.
