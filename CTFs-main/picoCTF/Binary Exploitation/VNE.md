Initial interaction with the target binary, `bin`, reveals that it depends on an environment variable named `SECRET_DIR`. Failure to set this variable results in an error and termination of the program. When `SECRET_DIR` is set to a valid directory path, such as `/root`, the binary executes and lists the contents of that directory. This action confirms two key details: the binary possesses privileges sufficient to access restricted directories like `/root`, and it uses the `SECRET_DIR` variable as input for a directory listing operation. The inability of the `ctf-player` user to directly read the discovered `flag.txt` file via `cat` further indicates that the `bin` program is running with elevated privileges, likely as the root user. The program's behavior strongly suggests that it constructs a shell command by incorporating the unsanitized value of the `SECRET_DIR` variable, creating a vector for command injection.



The identified vulnerability can be exploited by injecting a secondary command into the `SECRET_DIR` variable. This is accomplished by using a shell metacharacter to act as a command separator. The payload `SECRET_DIR="/root&cat /root/flag.txt"` was crafted for this purpose. The ampersand (`&`) is interpreted by the system shell as a control operator that separates distinct commands.

When the binary is executed with this environment variable, its internal logic likely forms a command string similar to `ls "/root&cat /root/flag.txt"`. This string is then passed to a command interpreter such as `/bin/sh`. The shell parses this string and, due to the presence of the `&` metacharacter, does not treat it as a single command with a malformed argument. Instead, it executes two sequential commands: first, `ls /root`, and second, `cat /root/flag.txt`.


The critical component of this exploit is the privilege context. Since the `bin` process executes as root, the shell it invokes also operates with root privileges. Consequently, the injected command, `cat /root/flag.txt`, is executed as the root user. This successfully bypasses the file system permissions that restrict access to the `ctf-player` user. The resulting output to standard out is a concatenation of the binary's own status messages and the outputs of both the intended `ls` command and the injected `cat` command. This final output contains the contents of `flag.txt`, thereby solving the challenge.
